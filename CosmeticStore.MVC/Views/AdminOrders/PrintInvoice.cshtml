@model CosmeticStore.MVC.Models.Order
@{
    Layout = null; // Không dùng Layout chung để trang in sạch sẽ
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>In Hóa Đơn #@Model.OrderId</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background: #fff;
            font-family: 'Times New Roman', Times, serif;
            color: #000;
        }

        .invoice-box {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            border: 1px solid #eee;
        }

        .invoice-title {
            font-size: 24px;
            font-weight: bold;
            text-transform: uppercase;
            text-align: center;
            margin-bottom: 20px;
        }

        .table-invoice th {
            background-color: #f8f9fa !important;
            border-bottom: 2px solid #000 !important;
        }

        .table-invoice td, .table-invoice th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        /* CSS riêng cho máy in */
        @@media print {
            .no-print {
                display: none !important;
            }

            .invoice-box {
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>

    <div class="invoice-box">
        <div class="text-end mb-3 no-print">
            <button onclick="window.print()" class="btn btn-primary btn-sm">🖨️ In ngay</button>
            <button onclick="window.close()" class="btn btn-secondary btn-sm">❌ Đóng</button>
        </div>

        <div class="row mb-4 border-bottom pb-3">
            <div class="col-6">
                <h4 class="fw-bold">COSMETIC STORE</h4>
                <small>Địa chỉ: 123 Đường ABC, Hà Nội</small><br>
                <small>Hotline: 1900 xxxx</small>
            </div>
            <div class="col-6 text-end">
                <h5 class="fw-bold">PHIẾU ĐÓNG GÓI</h5>
                <div>Mã đơn: <strong>#@Model.OrderId</strong></div>
                <div>Ngày đặt: @Model.OrderDate?.ToString("dd/MM/yyyy HH:mm")</div>
            </div>
        </div>

        <div class="mb-4">
            <strong>Người nhận:</strong> @Model.CustomerName <br>
            <strong>SĐT:</strong> @Model.CustomerPhone <br>
            <strong>Địa chỉ:</strong> @Model.ShippingAddress <br>
            <strong>Ghi chú:</strong> (Nếu có)
        </div>

        <table class="table table-invoice w-100 mb-4">
            <thead>
                <tr>
                    <th style="width: 50%">Tên sản phẩm</th>
                    <th class="text-center">Phân loại</th>
                    <th class="text-center">SL</th>
                    <th class="text-end">Đơn giá</th>
                    <th class="text-end">Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.OrderDetails)
                {
                    <tr>
                        <td>@item.Variant?.Product?.ProductName</td>
                        <td class="text-center">@item.Variant?.VariantName</td>
                        <td class="text-center fw-bold">@item.Quantity</td>
                        <td class="text-end">@item.UnitPrice.ToString("#,##0")</td>
                        <td class="text-end">@((item.Quantity * item.UnitPrice).ToString("#,##0"))</td>
                    </tr>
                }
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" class="text-end fw-bold">Tổng cộng:</td>
                    <td class="text-end fw-bold">@Model.TotalAmount.ToString("#,##0") đ</td>
                </tr>
            </tfoot>
        </table>

        <div class="row mt-5">
            <div class="col-6 text-center">
                <small>Người lập phiếu</small><br><br><br>
                <small>(Ký tên)</small>
            </div>
            <div class="col-6 text-center">
                <small>Ngày ..... tháng ..... năm 20...</small><br>
                <small>Người nhận hàng</small><br><br><br>
                <small>(Ký tên)</small>
            </div>
        </div>

        <div class="text-center mt-5 fst-italic small">
            Cảm ơn quý khách đã mua hàng!
        </div>
    </div>

    <script>
        // Tự động mở hộp thoại in khi trang tải xong
        window.onload = function() {
            setTimeout(function() { window.print(); }, 500);
        }
    </script>
</body>
</html>